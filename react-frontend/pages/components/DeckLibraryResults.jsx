import React from "react";

import abombwe from './../../assets/images/disciplines/abombwe.gif';
import animalism from './../../assets/images/disciplines/animalism.gif';
import auspex from './../../assets/images/disciplines/auspex.gif';
import celerity from './../../assets/images/disciplines/celerity.gif';
import chimerstry from './../../assets/images/disciplines/chimerstry.gif';
import daimoinon from './../../assets/images/disciplines/daimoinon.gif';
import dominate from './../../assets/images/disciplines/dominate.gif';
import dementation from './../../assets/images/disciplines/dementation.gif';
import fortitude from './../../assets/images/disciplines/fortitude.gif';
import melpominee from './../../assets/images/disciplines/melpominee.gif';
import mytherceria from './../../assets/images/disciplines/mytherceria.gif';
import necromancy from './../../assets/images/disciplines/necromancy.gif';
import obeah from './../../assets/images/disciplines/obeah.gif';
import obfuscate from './../../assets/images/disciplines/obfuscate.gif';
import obtenebration from './../../assets/images/disciplines/obtenebration.gif';
import potence from './../../assets/images/disciplines/potence.gif';
import presence from './../../assets/images/disciplines/presence.gif';
import protean from './../../assets/images/disciplines/protean.gif';
import quietus from './../../assets/images/disciplines/quietus.gif';
import sanguinus from './../../assets/images/disciplines/sanguinus.gif';
import serpentis from './../../assets/images/disciplines/serpentis.gif';
import spiritus from './../../assets/images/disciplines/spiritus.gif';
import temporis from './../../assets/images/disciplines/temporis.gif';
import thanatosis from './../../assets/images/disciplines/thanatosis.gif';
import thaumaturgy from './../../assets/images/disciplines/thaumaturgy.gif';
import valeren from './../../assets/images/disciplines/valeren.gif';
import vicissitude from './../../assets/images/disciplines/vicissitude.gif';
import visceratika from './../../assets/images/disciplines/visceratika.gif';
import abombwesup from './../../assets/images/disciplines/abombwesup.gif';
import animalismsup from './../../assets/images/disciplines/animalismsup.gif';
import auspexsup from './../../assets/images/disciplines/auspexsup.gif';
import celeritysup from './../../assets/images/disciplines/celeritysup.gif';
import chimerstrysup from './../../assets/images/disciplines/chimerstrysup.gif';
import daimoinonsup from './../../assets/images/disciplines/daimoinonsup.gif';
import dominatesup from './../../assets/images/disciplines/dominatesup.gif';
import dementationsup from './../../assets/images/disciplines/dementationsup.gif';
import fortitudesup from './../../assets/images/disciplines/fortitudesup.gif';
import melpomineesup from './../../assets/images/disciplines/melpomineesup.gif';
import mytherceriasup from './../../assets/images/disciplines/mytherceriasup.gif';
import necromancysup from './../../assets/images/disciplines/necromancysup.gif';
import obeahsup from './../../assets/images/disciplines/obeahsup.gif';
import obfuscatesup from './../../assets/images/disciplines/obfuscatesup.gif';
import obtenebrationsup from './../../assets/images/disciplines/obtenebrationsup.gif';
import potencesup from './../../assets/images/disciplines/potencesup.gif';
import presencesup from './../../assets/images/disciplines/presencesup.gif';
import proteansup from './../../assets/images/disciplines/proteansup.gif';
import quietussup from './../../assets/images/disciplines/quietussup.gif';
import sanguinussup from './../../assets/images/disciplines/sanguinussup.gif';
import serpentissup from './../../assets/images/disciplines/serpentissup.gif';
import spiritussup from './../../assets/images/disciplines/spiritussup.gif';
import temporissup from './../../assets/images/disciplines/temporissup.gif';
import thanatosissup from './../../assets/images/disciplines/thanatosissup.gif';
import thaumaturgysup from './../../assets/images/disciplines/thaumaturgysup.gif';
import valerensup from './../../assets/images/disciplines/valerensup.gif';
import vicissitudesup from './../../assets/images/disciplines/vicissitudesup.gif';
import visceratikasup from './../../assets/images/disciplines/visceratikasup.gif';
import defense from '././../../assets/images/disciplines/defense.gif';
import innocence from './../../assets/images/disciplines/innocence.gif';
import justice from './../../assets/images/disciplines/justice.gif';
import martyrdom from './../../assets/images/disciplines/martyrdom.gif';
import redemption from './../../assets/images/disciplines/redemption.gif';
import vengeance from './../../assets/images/disciplines/vengeance.gif';
import vision from './../../assets/images/disciplines/vision.gif';

import abomination from './../../assets/images/clans/abomination.gif';
import ahrimane from './../../assets/images/clans/ahrimane.gif';
import akunanse from './../../assets/images/clans/akunanse.gif';
import assamite from './../../assets/images/clans/assamite.gif';
import baali from './../../assets/images/clans/baali.gif';
import bloodbrother from './../../assets/images/clans/bloodbrother.gif';
import brujah from './../../assets/images/clans/brujah.gif';
import brujahantitribu from './../../assets/images/clans/brujahantitribu.gif';
import caitiff from './../../assets/images/clans/caitiff.gif';
import daughterofcacophony from './../../assets/images/clans/daughterofcacophony.gif';
import followerofset from './../../assets/images/clans/followerofset.gif';
import gangrel from './../../assets/images/clans/gangrel.gif';
import gangrelantitribu from './../../assets/images/clans/gangrelantitribu.gif';
import gargoyle from './../../assets/images/clans/gargoyle.gif';
import giovanni from './../../assets/images/clans/giovanni.gif';
import guruhi from './../../assets/images/clans/guruhi.gif';
import harbingerofskulls from './../../assets/images/clans/harbingerofskulls.gif';
import ishtarri from './../../assets/images/clans/ishtarri.gif';
import kiasyd from './../../assets/images/clans/kiasyd.gif';
import lasombra from './../../assets/images/clans/lasombra.gif';
import malkavian from './../../assets/images/clans/malkavian.gif';
import malkavianantitribu from './../../assets/images/clans/malkavianantitribu.gif';
import nagaraja from './../../assets/images/clans/nagaraja.gif';
import nosferatu from './../../assets/images/clans/nosferatu.gif';
import nosferatuantitribu from './../../assets/images/clans/nosferatuantitribu.gif';
import osebo from './../../assets/images/clans/osebo.gif';
import pander from './../../assets/images/clans/pander.gif';
import ravnos from './../../assets/images/clans/ravnos.gif';
import salubri from './../../assets/images/clans/salubri.gif';
import salubriantitribu from './../../assets/images/clans/salubriantitribu.gif';
import samedi from './../../assets/images/clans/samedi.gif';
import toreador from './../../assets/images/clans/toreador.gif';
import toreadorantitribu from './../../assets/images/clans/toreadorantitribu.gif';
import tremere from './../../assets/images/clans/tremere.gif';
import tremereantitribu from './../../assets/images/clans/tremereantitribu.gif';
import truebrujah from './../../assets/images/clans/truebrujah.gif';
import tzimisce from './../../assets/images/clans/tzimisce.gif';
import ventrue from './../../assets/images/clans/ventrue.gif';
import ventrueantitribu from './../../assets/images/clans/ventrueantitribu.gif';
import avenger from './../../assets/images/clans/avenger.gif';
import defender from './../../assets/images/clans/defender.gif';
import innocent from './../../assets/images/clans/innocent.gif';
import judge from './../../assets/images/clans/judge.gif';
import martyr from './../../assets/images/clans/martyr.gif';
import redeemer from './../../assets/images/clans/redeemer.gif';
import visionary from './../../assets/images/clans/visionary.gif';

import action from './../../assets/images/types/action.gif';
import actionmodifier from './../../assets/images/types/actionmodifier.gif';
import ally from './../../assets/images/types/ally.gif';
import combat from './../../assets/images/types/combat.gif';
import conviction from './../../assets/images/types/conviction.gif';
import equipment from './../../assets/images/types/equipment.gif';
import event from './../../assets/images/types/event.gif';
import master from './../../assets/images/types/master.gif';
import politicalaction from './../../assets/images/types/politicalaction.gif';
import power from './../../assets/images/types/power.gif';
import reaction from './../../assets/images/types/reaction.gif';
import reflex from './../../assets/images/types/reflex.gif';
import retainer from './../../assets/images/types/retainer.gif';

import blood1 from './../../assets/images/misc/blood1.png';
import blood2 from './../../assets/images/misc/blood2.png';
import blood3 from './../../assets/images/misc/blood3.png';
import blood4 from './../../assets/images/misc/blood4.png';
import blood5 from './../../assets/images/misc/blood5.png';
import blood6 from './../../assets/images/misc/blood6.png';
import bloodx from './../../assets/images/misc/bloodx.png';

import pool1 from './../../assets/images/misc/pool1.png';
import pool2 from './../../assets/images/misc/pool2.png';
import pool3 from './../../assets/images/misc/pool3.png';
import pool4 from './../../assets/images/misc/pool4.png';
import pool5 from './../../assets/images/misc/pool5.png';
import pool6 from './../../assets/images/misc/pool6.png';
import poolx from './../../assets/images/misc/poolx.png';

import burn from './../../assets/images/misc/burn.gif';

function DeckLibraryQuantity(props) {
  const deckCardChange = props.deckCardChange;
  const deckid = props.deckid;
  const cardid = props.cardid;
  let q = 0;
  if (props.q == 0) {
    q = null;
  } else {
    q = props.q;
  }

  return (
    <td className='quantity'>
      <div className='d-flex align-items-center justify-content-between'>
        <button className="btn btn-outline-secondary" type="button" onClick={(e) => deckCardChange(deckid, cardid, q + 1)}>
          +
        </button>
        {' '}{q}{' '}
        <button className="btn btn-outline-secondary" type="button" onClick={(e) => deckCardChange(deckid, cardid, q - 1)}>
          -
        </button>
      </div>
    </td>
  )
}

function DeckLibraryCost(props) {
  const costicons = {
    1: [blood1, pool1],
    2: [blood2, pool2],
    3: [blood3, pool3],
    4: [blood4, pool4],
    5: [blood5, pool5],
    6: [blood6, pool6],
    X: [bloodx, poolx],
  };
  const imgClass='cost-image-results';
  let imgSrc='';
  if (props.valueBlood) {
    imgSrc=costicons[props.valueBlood][0];
  } else if (props.valuePool){
    imgSrc=costicons[props.valuePool][1];
  }

  return (
    <td className='cost'>
      <img className={imgClass} src={imgSrc} />
    </td>
  );
}

function DeckLibraryDiscipline(props) {
  const disciplineicons = {
    Abombwe: abombwe,
    Animalism: animalism,
    Auspex: auspex,
    Celerity: celerity,
    Chimerstry: chimerstry,
    Daimoinon: daimoinon,
    Dementation: dementation,
    Dominate: dominate,
    Fortitude: fortitude,
    Melpominee: melpominee,
    Mytherceria: mytherceria,
    Necromancy: necromancy,
    Obeah: obeah,
    Obfuscate: obfuscate,
    Obtenebration: obtenebration,
    Potence: potence,
    Presence: presence,
    Protean: protean,
    Quietus: quietus,
    Sanguinus: sanguinus,
    Serpentis: serpentis,
    Spiritus: spiritus,
    Temporis: temporis,
    Thanatosis: thanatosis,
    Thaumaturgy: thaumaturgy,
    Valeren: valeren,
    Vicissitude: vicissitude,
    Visceratika: visceratika,
    Defense: defense,
    Innocence: innocence,
    Justice: justice,
    Martyrdom: martyrdom,
    Redemption: redemption,
    Vengeance: vengeance,
    Vision: vision,
  };


  const imgClass='discipline-image-results';
  let disciplines_images;

  if (props.value.indexOf('&') != -1) {
    const disciplines = props.value.split(' & ');
    let items = disciplines.length;
    disciplines_images = disciplines.map((discipline, index) => {
      const imgSrc = disciplineicons[discipline];
      if (items > 1) {
        items -= 1;
        return (
          <span key={index}>
            <img className={imgClass} src={imgSrc} />{'+'}
          </span>
        );
      } else {
        return (
          <span key={index}>
            <img className={imgClass} src={imgSrc} />
          </span>
        );
      }
    });
  } else if (props.value.indexOf('/') != -1) {
    const disciplines = props.value.split('/');
    let items = disciplines.length;
    disciplines_images = disciplines.map((discipline, index) => {
      const imgSrc = disciplineicons[discipline];
      if (items > 1) {
        items -= 1;
        return (
          <span key={index}>
            <img className={imgClass} src={imgSrc} />{' / '}
          </span>
        );
      } else {
        return (
          <span key={index}>
            <img className={imgClass} src={imgSrc} />
          </span>
        );
      }
    });
  } else {
    const disciplines = props.value;
    const imgSrc = disciplineicons[disciplines];
    disciplines_images =
      <img className={imgClass} src={imgSrc} />;
  }

  return (
    <td className='disciplines'>
      {disciplines_images}
    </td>
  );
}

function DeckLibraryName(props) {
  return (
    <td className='name'>
      {props.value}
    </td>
  );
}


function DeckLibraryBurn(props) {
  const imgClass='burn-image-results';
  const imgSrc=burn;
  if (props.value) {
    return (
      <td className='burn'>
        <img className={imgClass} src={imgSrc} />
      </td>
    );
  } else {
    return <td className='burn'></td>;
  }
}


function DeckLibraryClan(props) {
  const clanicons = {
    Abomination: abomination,
    Ahrimane: ahrimane,
    Akunanse: akunanse,
    Assamite: assamite,
    Baali: baali,
    'Blood Brother': bloodbrother,
    Brujah: brujah,
    'Brujah antitribu': brujahantitribu,
    Caitiff: caitiff,
    'Daughter of Cacophony': daughterofcacophony,
    'Follower of Set': followerofset,
    Gangrel: gangrel,
    'Gangrel antitribu': gangrelantitribu,
    Gargoyle: gargoyle,
    Giovanni: giovanni,
    Guruhi: guruhi,
    'Harbinger of Skulls': harbingerofskulls,
    Ishtarri: ishtarri,
    Kiasyd: kiasyd,
    Lasombra: lasombra,
    Malkavian: malkavian,
    'Malkavian antitribu': malkavianantitribu,
    Nagaraja: nagaraja,
    Nosferatu: nosferatu,
    'Nosferatu antitribu': nosferatuantitribu,
    Osebo: osebo,
    Pander: pander,
    Ravnos: ravnos,
    Salubri: salubri,
    'Salubri antitribu': salubriantitribu,
    Samedi: samedi,
    Toreador: toreador,
    'Toreador antitribu': toreadorantitribu,
    Tremere: tremere,
    'Tremere antitribu': tremereantitribu,
    'True Brujah': truebrujah,
    Tzimisce: tzimisce,
    Ventrue: ventrue,
    'Ventrue antitribu': ventrueantitribu,
    Avenger: avenger,
    Defender: defender,
    Innocent: innocent,
    Judge: judge,
    Martyr: martyr,
    Redeemer: redeemer,
    Visionary: visionary,
  };

  const imgClass='clan-image-results';
  let clan_images;

  if (props.value.indexOf('/') != -1) {
    const clans = props.value.split('/');
    let items = clans.length;
    clan_images = clans.map((clan, index) => {
      const imgSrc = clanicons[clan];
      if (items > 1) {
        items -= 1;
        return (
          <span key={index}>
            <img className={imgClass} src={imgSrc} />{' / '}
          </span>
        );
      } else {
        return (
          <span key={index}>
            <img className={imgClass} src={imgSrc} />
          </span>
        );
      }
    });
  } else {
    const imgSrc = clanicons[props.value];
    clan_images =
      <img className={imgClass} src={imgSrc} />;
  }

  return (
    <td className='clan'>
      {clan_images}
    </td>
  );
}

function DeckLibraryTypeHeader(props) {
  const typeicons = {
    'Action': action,
    'Action Modifier': actionmodifier,
    'Ally': ally,
    'Combat': combat,
    'Conviction': conviction,
    'Equipment': equipment,
    'Event': event,
    'Master': master,
    'Political Action': politicalaction,
    'Power': power,
    'Reaction': reaction,
    'Reflex': reflex,
    'Retainer': retainer,
  };
  const imgClass='type-image-results';
  const cardtypes = props.cardtype.split('/');
  const cardtype_images = cardtypes.map((cardtype, index) => {
    const imgSrc=typeicons[cardtype];
    return (
      <img key={index} className={imgClass} src={imgSrc} />
    );
  });

  return(
    <div>
      {cardtype_images} {' '} {props.cardtype} [{props.total}]
    </div>
  );
}


function DeckLibraryBody(props) {
  let resultTrClass='library-result-even';
  const cards = props.cards.map((card, index) => {
    if (resultTrClass == 'library-result-even') {
      resultTrClass = 'library-result-odd';
    } else {
      resultTrClass = 'library-result-even';
    }
    if (card[0]['Clan']) {
      return (
        <tr className={resultTrClass} key={index}>
          <DeckLibraryQuantity cardid={card[0].Id} q={card[1]} deckid={props.deckid} deckCardChange={props.deckCardChange} />
          <DeckLibraryName value={card[0]['Name']} />
          <DeckLibraryCost valueBlood={card[0]['Blood Cost']} valuePool={card[0]['Pool Cost']} />
          <DeckLibraryClan value={card[0]['Clan']} />
          <DeckLibraryBurn value={card[0]['Burn Option']} />
        </tr>
      );
    } else {
      return (
        <tr className={resultTrClass} key={index}>
          <DeckLibraryQuantity cardid={card[0].Id} q={card[1]} deckid={props.deckid} deckCardChange={props.deckCardChange} />
          <DeckLibraryName value={card[0]['Name']} />
          <DeckLibraryCost valueBlood={card[0]['Blood Cost']} valuePool={card[0]['Pool Cost']} />
          <DeckLibraryDiscipline value={card[0]['Discipline']} />
          <DeckLibraryBurn value={card[0]['Burn Option']} />
        </tr>
      )
    }
  });

  return <tbody>{cards}</tbody>;
}

function DeckLibraryByTypeTable(props) {
  return (
    <div>
      <DeckLibraryTypeHeader cardtype={props.cardtype} total={props.total}/>
      <table className='library-result-table'>
        <DeckLibraryBody deckid={props.deckid} deckCardChange={props.deckCardChange} cards={props.cards} />
      </table>
    </div>
  );
}

function DeckLibraryResults(props) {

  const library = {};
  const library_side = {};

  Object.keys(props.cards).map((card, index) => {
    if (props.cards[card].q > 0) {
      library[card] = props.cards[card];
    } else {
      library_side[card] = props.cards[card];
    }
  });

  const cardtype_sorted = [
    'Master',
    'Conviction',
    'Power',
    'Action',
    'Action/Reaction',
    'Action/Combat',
    'Political Action',
    'Ally',
    'Equipment',
    'Retainer',
    'Action Modifier',
    'Action Modifier/Combat',
    'Action Modifier/Reaction',
    'Reaction',
    'Reaction/Action Modifier',
    'Reaction/Combat',
    'Combat',
    'Combat/Action Modifier',
    'Combat/Reaction',
    'Event',
  ];

  const LibraryDeck = [];
  const LibrarySideDeck = [];
  let library_total = 0;

  for (const card in library) {
    library_total += library[card].q;
    const cardtype = library[card].c['Type'];
    if (library[cardtype] === undefined) {
      library[cardtype] = [];
    }
    library[cardtype].push([library[card].c, library[card].q]);
  }

  for (const card in library_side) {
    const cardtype = library_side[card].c['Type'];
    if (library_side[cardtype] === undefined) {
      library_side[cardtype] = [];
    }
    library_side[cardtype].push([library_side[card].c, library_side[card].q]);
  }

  for (const cardtype of cardtype_sorted) {
    if (library[cardtype] !== undefined) {
      let total = 0;
      for (const card of library[cardtype]) {
        total += card[1];
      }
      LibraryDeck.push(
        <div key={cardtype}>
          <DeckLibraryByTypeTable deckCardChange={props.deckCardChange} deckid={props.deckid} cards={library[cardtype]} cardtype={cardtype} total={total} />
          <br />
        </div>
      );
    }

    if (library_side[cardtype] !== undefined) {
      let total = 0;
      for (const card of library_side[cardtype]) {
        total += card[1];
      }
      LibrarySideDeck.push(
        <div key={cardtype}>
          <DeckLibraryByTypeTable deckCardChange={props.deckCardChange} deckid={props.deckid} cards={library_side[cardtype]} cardtype={cardtype} total={total} />
          <br />
        </div>
      );
    }
  }

  return (
    <div>
      <div className='deck-library'>
        <b>Library [{library_total}]:</b>
        {LibraryDeck}
      </div>
      { Object.keys(library_side).length > 0 &&
      <div className='deck-sidelibrary'>
        <b>Side Library:</b>
        {LibrarySideDeck}
      </div>
    }
    </div>
  );
}

export default DeckLibraryResults;
